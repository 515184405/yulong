$(function(){"use strict";var p,c=window.console||{log:function(){}},i=window.URL||window.webkitURL,n=$("#image"),s=$("#download"),a=$("#dataX"),t=$("#dataY"),o=$("#dataHeight"),r=$("#dataWidth"),d=$("#dataRotate"),l=$("#dataScaleX"),v=$("#dataScaleY"),h={aspectRatio:16/9,preview:".img-preview",crop:function(e){a.val(Math.round(e.detail.x)),t.val(Math.round(e.detail.y)),o.val(Math.round(e.detail.height)),r.val(Math.round(e.detail.width)),d.val(e.detail.rotate),l.val(e.detail.scaleX),v.val(e.detail.scaleY)}},g=n.attr("src"),m="cropped.jpg",u="image/jpeg";$('[data-toggle="tooltip"]').tooltip(),n.on({ready:function(e){c.log(e.type)},cropstart:function(e){},cropmove:function(e){},cropend:function(e){},crop:function(e){c.log(e.type)},zoom:function(e){}}).cropper(h),$.isFunction(document.createElement("canvas").getContext)||$('button[data-method="getCroppedCanvas"]').prop("disabled",!0),void 0===document.createElement("cropper").style.transition&&($('button[data-method="rotate"]').prop("disabled",!0),$('button[data-method="scale"]').prop("disabled",!0)),void 0===s[0].download&&s.addClass("disabled"),$(".docs-toggles").on("change","input",function(){var e,a,t=$(this),o=t.attr("name"),r=t.prop("type");n.data("cropper")&&("checkbox"===r?(h[o]=t.prop("checked"),e=n.cropper("getCropBoxData"),a=n.cropper("getCanvasData"),h.ready=function(){n.cropper("setCropBoxData",e),n.cropper("setCanvasData",a)}):"radio"===r&&(h[o]=t.val()),n.cropper("destroy").cropper(h))}),$(".docs-buttons").on("click","[data-method]",function(){var e,a,t,o=$(this),r=o.data(),d=n.data("cropper");if(!o.prop("disabled")&&!o.hasClass("disabled")&&d&&r.method){if(void 0!==(r=$.extend({},r)).target&&(a=$(r.target),void 0===r.option))try{r.option=JSON.parse(a.val())}catch(e){c.log(e.message)}switch(e=d.cropped,r.method){case"rotate":e&&0<h.viewMode&&n.cropper("clear");break;case"getCroppedCanvas":"image/jpeg"===u&&(r.option||(r.option={}),r.option.fillColor="#fff")}switch(t=n.cropper(r.method,r.option,r.secondOption),r.method){case"rotate":e&&0<h.viewMode&&n.cropper("crop");break;case"scaleX":case"scaleY":$(this).data("option",-r.option);break;case"getCroppedCanvas":t&&($("#getCroppedCanvasModal").modal().find(".modal-body").html(t),s.hasClass("disabled")||(download.download=m,s.attr("href",t.toDataURL(u))));break;case"destroy":p&&(i.revokeObjectURL(p),p="",n.attr("src",g))}if($.isPlainObject(t)&&a)try{a.val(JSON.stringify(t))}catch(e){c.log(e.message)}}}),$(document.body).on("keydown",function(e){if(e.target===this&&n.data("cropper")&&!(300<this.scrollTop))switch(e.which){case 37:e.preventDefault(),n.cropper("move",-1,0);break;case 38:e.preventDefault(),n.cropper("move",0,-1);break;case 39:e.preventDefault(),n.cropper("move",1,0);break;case 40:e.preventDefault(),n.cropper("move",0,1)}});var f=$("#inputImage");i?f.change(function(){var e,a=this.files;n.data("cropper")&&a&&a.length&&(e=a[0],/^image\/\w+$/.test(e.type)?(m=e.name,u=e.type,p&&i.revokeObjectURL(p),p=i.createObjectURL(e),n.cropper("destroy").attr("src",p).cropper(h),f.val("")):window.alert("Please choose an image file."))}):f.prop("disabled",!0).parent().addClass("disabled")});